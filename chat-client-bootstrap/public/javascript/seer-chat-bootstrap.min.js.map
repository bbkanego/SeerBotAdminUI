{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./public/javascript/seer-chat-bootstrap.js"],"names":["window","SEER_CHAT_BOOTSTRAP","config","iframeCommonStyle","iframeHiddenStyle","iframeDisplayStyle","internalConf","iframe","undefined","iframeTargetOrigin","iframeHandle","receiverNonce","senderNonce","externalConf","_initialize","getConfig","validateConfig","removeEventListener","handleMessage","addEventListener","setChatIframe","_hide","setAttribute","_show","_destroy","payload","payloadString","JSON","stringify","postMessage","targetDivObj","document","getElementById","targetDivId","emptyNode","createElement","sandbox","src","sdkUrl","collapsed","width","height","title","appendChild","contentWindow","sendInitialize","uuid","replace","c","r","Math","random","v","toString","node","hasChildNodes","removeChild","firstChild","SEER_CHAT_config","handleError","errorStr","errorHandler","console","log","brandIdentifier","loadCustomCSS","loadCustomResourceBunle","event","origin","parse","data","callback","nonce","messageParts","split","sendConfig","callbackContext","callbackState","callbacks","err","configString","source","initialize","hide","show","destroy","define"],"mappings":"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","file":"seer-chat-bootstrap.min.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./public/javascript/seer-chat-bootstrap.js\");\n","/**\n * This JS is the entry point to the chatbot. The client will include this JS on there website with\n * configuration params.\n * The below implements the \"Self Executing\" JS\n * paradigm per: http://markdalgleish.com/2011/03/self-executing-anonymous-functions/\n * https://stackoverflow.com/questions/14322708/what-is-self-executing-anonymous-function-or-what-is-this-code-doing\n *\n * Note that this JS will be loaded by the client on there website an thus\n * we will use plain old JS here. No jquery etc\n * will be used here.\n */\nwindow.SEER_CHAT_BOOTSTRAP = (function(config) {\n  const iframeCommonStyle = 'border-width: 0;border-style: none;min-width: 100%;';\n  const iframeHiddenStyle = iframeCommonStyle + 'display: none';\n  const iframeDisplayStyle = iframeCommonStyle + 'display: block';\n\n  const internalConf = {\n    iframe: undefined,\n    iframeTargetOrigin: undefined,\n    iframeHandle: undefined,\n    receiverNonce: undefined,\n    senderNonce: undefined,\n  };\n\n  let externalConf;\n\n  const _initialize = function() {\n    if (config) {\n      externalConf = config;\n    } else {\n      if (!getConfig()) {\n        return false;\n      }\n    }\n\n    if (!validateConfig()) {\n      return false;\n    }\n\n    window.removeEventListener('message', handleMessage, false);\n    window.addEventListener('message', handleMessage, false);\n\n    setChatIframe();\n\n    return true;\n  };\n\n  const _hide = function() {\n    internalConf.iframe.setAttribute('style', iframeHiddenStyle);\n  };\n\n  const _show = function() {\n    internalConf.iframe.setAttribute('style', iframeDisplayStyle);\n  };\n\n  const _destroy = function() {\n    const payload = {};\n    const payloadString = JSON.stringify(payload);\n\n    internalConf.iframeHandle.postMessage(\n        internalConf.senderNonce + ':destroy:' + payloadString,\n        internalConf.iframeTargetOrigin\n    );\n  };\n\n  const setChatIframe = function() {\n    const targetDivObj = document.getElementById(externalConf.targetDivId);\n    emptyNode(targetDivObj);\n\n    const iframe = document.createElement('iframe');\n    iframe.sandbox = 'allow-same-origin allow-scripts allow-forms allow-popups';\n    iframe.src = externalConf.sdkUrl + '/index.html';\n    if (externalConf.collapsed) {\n      iframe.setAttribute('style', iframeHiddenStyle);\n    } else {\n      iframe.setAttribute('style', iframeDisplayStyle);\n    }\n    iframe.setAttribute('scrolling', 'no');\n    iframe.setAttribute('frameborder', '0');\n    iframe.setAttribute('allowfullscreen', 'true');\n    // iframe will show in the div.It will take the width of the div\n    iframe.width = '100%';\n    iframe.height = 300;\n    iframe.title = 'Seer Chat';\n\n    targetDivObj.appendChild(iframe);\n\n    // keep handle to the content window for posting events in and out of the iframe.\n    internalConf.iframe = iframe;\n    internalConf.iframeHandle = iframe.contentWindow;\n\n    iframe.removeEventListener('load', function() {\n      sendInitialize();\n    });\n    iframe.addEventListener('load', function() {\n      sendInitialize();\n    });\n  };\n\n  const sendInitialize = function() {\n    internalConf.receiverNonce = uuid();\n\n    internalConf.iframeHandle.postMessage(\n        ':initialize:' + internalConf.receiverNonce,\n        internalConf.iframeTargetOrigin\n    );\n  };\n\n  const uuid = function() {\n    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\n      const r = (Math.random() * 16) | 0;\n      const v = c == 'x' ? r : (r & 0x3) | 0x8;\n      return v.toString(16);\n    });\n  };\n\n  const emptyNode = function(node) {\n    while (node.hasChildNodes()) {\n      node.removeChild(node.firstChild);\n    }\n  };\n\n  const getConfig = function() {\n    if (!window.SEER_CHAT_config) {\n      handleError('Chat cannot be inited since bootstrap config SEER_CHAT_config not defined');\n    }\n    externalConf = window.SEER_CHAT_config;\n    return true;\n  };\n\n  const handleError = function(errorStr) {\n    if (externalConf.errorHandler) {\n      externalConf.errorHandler(errorStr);\n    } else {\n      console.log(errorStr);\n    }\n  };\n\n  const validateConfig = function() {\n    if (externalConf.brandIdentifier) {\n      externalConf.loadCustomCSS = true;\n      externalConf.loadCustomResourceBunle = true;\n    }\n\n    if (!externalConf.targetDivId) {\n      return false;\n    }\n    return true;\n  };\n\n  const handleMessage = function(event) {\n    if (internalConf.iframeTargetOrigin !== event.origin) {\n      handleError('Error: recieved an iframe post message froma different post: ' + event.origin);\n      return;\n    }\n\n    const payload = JSON.parse(event.data);\n    const callback = payload.callback;\n    const data = payload.data ? payload.data : {};\n\n    if (\n      payload.nonce ||\n      (internalConf.receiverNonce && payload.nonce !== internalConf.receiverNonce)\n    ) {\n      handleError('Received an iframe post message with an invalid nonce');\n      return;\n    }\n\n    const messageParts = callback.split(':');\n    switch (messageParts[0]) {\n      case 'getConfig':\n        sendConfig(event, payload.data.nonce);\n        break;\n      case 'callback':\n        const callbackContext = messageParts[1];\n        const callbackState = messageParts[2];\n        if (\n          externalConf.callbacks &&\n          externalConf.callbacks[callbackContext] &&\n          externalConf.callbacks[callbackContext][callbackState]\n        ) {\n          try {\n            externalConf.callbacks[callbackContext][callbackState](data);\n          } catch (err) {\n            handleError('Error thrown by callback function: ' + err);\n          }\n        }\n        break;\n      default:\n        break;\n    }\n  };\n\n  const sendConfig = function(event, nonce) {\n    if (!internalConf.senderNonce) {\n      internalConf.senderNonce = nonce;\n    }\n\n    const configString = JSON.stringify(externalConf);\n    event.source.postMessage(\n        internalConf.senderNonce + ':setConfig:' + configString,\n        internalConf.iframeTargetOrigin\n    );\n  };\n\n  return {\n    initialize: _initialize,\n    hide: _hide,\n    show: _show,\n    destroy: _destroy,\n  };\n})();\n\n// register module with AMD\nif (typeof define === 'function' && define.amd) {\n  define('seer-chat-bootstrap', [], window.SEER_CHAT_BOOTSTRAP);\n} else if (typeof module !== 'undefined' && module.exports) {\n  module.exports = window.SEER_CHAT_BOOTSTRAP;\n}\n"],"sourceRoot":""}